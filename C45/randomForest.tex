%=================================================
\sectionDark{Random Forest}
%=================================================
\begin{frame}
  \frametitle{Introducción -- I}
  \only<1>{\alert{Hasta ahora:}\\ \qquad Un conjunto de entrenamiento $\rightarrow$ Un árbol
  de clasificación\\}

  \only<2>{\alert{Random forest:}\\ \qquad Un conjunto de entrenamiento $\rightarrow$ Varios árboles
    de clasificación\\}

  \vspace{0.3cm}

  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{tabular}{ccccc}
        Sexo & Altura & Peso & Exp. & Act. \\ \hline
        H & 1,55 & 45 & A+ & Fútbol \\
        H & 1,67 & 58 & C & Fútbol \\
        M & 1,45 & 45 & B & Fútbol \\
        M & 1,58 & 50 & A+ & Pádel \\
        H & 1,20 & 40 & B & Fútbol \\
        M & 1,80 & 60 & A & Pádel \\
        $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ \\ \hline
      \end{tabular}
    \end{column}
    \begin{column}{0.5\textwidth}
      \vspace{0.3cm}
      \includegraphics<1>[width=\textwidth]{images/randomForest/1arbol.png}
      \includegraphics<2->[width=\textwidth]{images/randomForest/bosque.png}
    \end{column}
  \end{columns}

\end{frame}


\begin{frame}
  \frametitle{Introducción -- II}

  \begin{block}{Random forest\footnote{Técnica propuesta por primera vez en \cite{randomForest}.}}
    \begin{itemize}
    \item ¿Cómo se clasifica una instancia?
    \item ¿Cómo se generan varios árboles con el mismo conjunto de
      entrenamiento?
    \item ¿Cómo se genera un árbol en concreto?
    \end{itemize}
  \end{block}

   
\end{frame}


\begin{frame}[fragile,fragile]
  \frametitle{Clasificación de instancias}
  
  Al existir varios árboles, pueden existir varias clases posibles para una
  instancia.\\
  \quad La clase final será aquella que más veces aparece elegida (\alert{moda}).
\begin{lstlisting}[frame=single, numbers=left]
clasifica(x):
  for_each a in arboles:
     cjto += clasifica(x, a)

  return moda(cjto)
\end{lstlisting}

\begin{columns}
  \begin{column}{0.6\textwidth}
    \flushright
    \includegraphics<1>[scale=0.2]{images/randomForest/arbol_class1.png}
    \includegraphics<2->[scale=0.2]{images/randomForest/arbol_class2.png}
  \end{column}
  \begin{column}{0.4\textwidth}
    \includegraphics<-2>[scale=0.2]{images/randomForest/nodo.png}
    \includegraphics<3->[scale=0.2]{images/randomForest/nodo_naranja.png}
  \end{column}
\end{columns}

\end{frame}


\begin{frame}[shrink]
  \frametitle{Generación de árboles --- Selección de instancias}
  \alert{Problema:} A partir de un mismo conjunto de entrenamiento se
  desean obtener distintos árboles de clasificación.\\
  \vspace{\baselineskip} % hack chapuza para meter una linea entre párrafos
  \alert{Solución:}
  Técnica conocida como \textbf{Bagging} o \emph{Bootstrap aggregating}:
  \begin{itemize}
  \item Dado un conjunto de entrenamiento con $N$ instancias, obtener $B$
    conjuntos de entrenamiento de tamaño $n'$ ($n' < N$).
  \item Utilizar \textit{muestreo aleatorio con reemplazamiento}.
  \end{itemize}

  \includegraphics<1>[width=\textwidth]{images/randomForest/bagging_pre.png}
  \includegraphics<2->[width=\textwidth]{images/randomForest/bagging.png}

\end{frame}


\begin{frame}[t]
  \frametitle{Generación de árboles --- Selección de atributos}
  \onslide<1->{
    -- En un nodo split, ¿qué atributo escoger para hacer la división? --\\
    \vspace{\baselineskip}
  }
  
  \only<1>{
    \textbf{ID3:} Escoger entre \texttt{todos} los atributos, aquel que
    proporcione una mayor ganancia de información.\\
    \vspace{\baselineskip}
    \alert{Problemas:} 
    \vspace{-0.5\baselineskip}
    \begin{itemize}
    \item Un atributo muy decisivo en un árbol seguramente también lo sea en
      el resto de árboles, por lo que producirá árboles muy correlacionados.
    \item Comparar entre todos los atributos en todos los árboles necesita
      muchos recursos.
    \end{itemize}
  }

  \only<2->{
    \alert{Solución:} \textbf{Feature bagging}\footnote{Descrita
      principalmente en~\cite{FeatureBagging}}:
    \begin{itemize}
    \item En cada nodo split, observar solamente un subconjunto aleatorio
      de tamaño $m'$ del conjunto de atributos restantes.
    \item Sobre el subconjunto, escoger el que mayor ganancia de
      información proporcione (similar a ID3).
    \item Si el número de atributos totales es $m$, el subconjunto de
      tamaño $m'$ se calcula de manera aleatoria, donde:\\
$$
      m' =
      \left\{
	\begin{array}{ll}
          \lfloor \sqrt{m} \rfloor  & \mbox{si } \sqrt{m} \geq 5 \\
          m &  c.c.
	\end{array}
      \right.
$$
\end{itemize}
  }

  
\end{frame}

%
%
%%%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "PRESENTACION.tex"
%%% End:
